<!DOCTYPE html>
<html>
<head lang="en">
	<meta charset="UTF-8">
	<title>Gra</title>
	<link rel="stylesheet" href="style-foka.css">
</head>
<body>

<div id="game_background">
<div id="heart">
<img src="images/heart.png"/>
<img src="images/heart.png"/>
<img src="images/heart.png"/>
</div>
<p>Score:</p><div class="score">0</div>
<img class="animal" src="images/foka1.png"/>

</div>


<script src="js/jquery-3.1.1.js"></script>
<script>

 $(document).ready(function ($) {

var totalFood = 0;
var fallRate = 3000;
var images = ['ryba1.png', 'ryba2.png', 'ryba3.png', 'ryba4.png', 'puszka1.png', 'butelka2.png', 'klucz.png', 'but3.png'];
var timer = Math.floor(fallRate);
var foodCaught = 0;

//var randomnumber = Math.floor(Math.random()*$("#food-times").children().length);
// "src="images/ryba1.png"/
//src="images/' + images[Math.floor(Math.random() * images.length)] + '

function foodItems() {
	
	var foodXPos = Math.floor(Math.random() * $('#game_background').width() * 0.8);
	
	console.log (foodXPos )
	
	var foodSpeed = Math.floor(Math.random() + fallRate);
	var $foodItem = $('<img class="food-item" style="position:absolute; top:-50px;" src="images/' + images[Math.floor(Math.random() * images.length)] + '">');
	//var foodItem = Math.floor(Math.random()*$("#food-times").children().length);
	
	$('#game_background').prepend($foodItem);

	// if ( $("#food-item").attr("src") == "images/ryba1.png"  ) {
 //  $(this).attr('id', 'food-item-good');

	
	$(".food-item").css({'left':foodXPos+'px'});
	
	$(".food-item")
		//.delay(Math.random() * 500)
		//.css({'z-index: 0'})
		.animate({
		"top": "+400px"},
		foodSpeed,
		function(){
		$(this).remove();
		totalFood++;
		if(totalFood==30){
			fallRate *= 0.8;
		}
	});
	
	
	

	//$('[class="food-item"]').each(function( e ){ 
   $(".food-item").each(function( e ){  	
	
 if ( ($(this).attr("src") == "images/puszka1.png") || 
 ($(this).attr("src") == "images/butelka2.png") || 
 ($(this).attr("src") == "images/klucz.png") || 
 ($(this).attr("src") == "images/but3.png") 
 
 ) 
 
//{$(this).attr('id', 'food-item-bad');
{$(this).addClass('food-item-bad');
 }
 
  else if  ( ($(this).attr("src") == "images/ryba1.png") || 
 ($(this).attr("src") == "images/ryba2.png") || 
 ($(this).attr("src") == "images/ryba3.png") || 
 ($(this).attr("src") == "images/ryba4.png") 
 ) 
 
 //{$(this).attr('id', 'food-item-good');
 {$(this).addClass('food-item-good');
 }
 
 });
	
	
}

	
var myInterval = setInterval(function(){
foodItems();
}, timer);



setInterval(function(){


		var animal = $(".animal").offset();
	    var foodGood = $(".food-item-good").offset();
	    var foodBad = $(".food-item-bad").offset();
		


	if ( animal.left > foodGood.left - 50  && animal.left < foodGood.left + 50 && foodGood.top > 350) {
		foodCaught++;
		$('.score').text(foodCaught);
	}
	

	else if ( animal.left > foodBad.left - 50 && animal.left < foodBad.left + 50 && foodBad.top > 350) {
		//$('#heart img').last().remove();
		foodCaught--;
		$('.score').text(foodCaught);
		
		$('#heart').children().last().remove();
		var $beCareful = $('<p id="be-careful" style="position: absolute; bottom: 300px; left: 65px; color: red; font-size: 25px;" >Be Careful!</p>');
	$('#game_background').prepend($beCareful);
	$('#be-careful').fadeOut(5000); 
	}


	
	
     else if ( !($('#heart').children().length > 0) ) {
    clearInterval (myInterval);
	var $gameOver = $('<p id="game-over" style="position: absolute; bottom: 300px; left: 65px; color: black; font-size: 30px;" >GAME OVER</p>');
	$('#be-careful').hide();
	$('#game_background').prepend($gameOver);
	
	
	}
	
	
	

}, 250);


document.body.onkeydown = function(e){
		if (e.keyCode == 37 && parseInt($(".animal").css('left'))>0) {
			$(".animal").animate({left: "-=5"}, 0);
		}
		else if (e.keyCode == 39 && parseInt($(".animal").css('right'))>0) {
			$(".animal").animate({left: "+=5"}, 0);
		}
	}

});


</script>

</body>
</html>
